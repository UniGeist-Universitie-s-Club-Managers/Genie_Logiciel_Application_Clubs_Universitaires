{% extends 'base.html' %}
{% load static %}
{% block title %}Calendrier des Événements{% endblock %}

{% block content %}
<div class="container-fluid mt-5">
    <!-- Hero Section -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="hero-calendar text-center py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; color: white; box-shadow: 0 15px 35px rgba(0,0,0,0.1);">
                <i class="fas fa-calendar-alt fa-4x mb-3 animate__animated animate__bounce"></i>
                <h1 class="display-4 font-weight-bold animate__animated animate__fadeInUp">Calendrier Interactif</h1>
                <p class="lead animate__animated animate__fadeInUp animate__delay-1s">Découvrez tous les événements à venir de nos clubs universitaires</p>
                <div class="mt-4 animate__animated animate__fadeInUp animate__delay-2s">
                    <span class="badge badge-light p-2 mr-2"><i class="fas fa-mouse-pointer"></i> Cliquez sur un événement</span>
                    <span class="badge badge-light p-2"><i class="fas fa-info-circle"></i> Détails complets</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Calendar Container -->
    <div class="row">
        <div class="col-12">
            <div class="calendar-wrapper" style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); padding: 30px;">
                <div id="calendar" class="animate__animated animate__fadeIn"></div>
            </div>
        </div>
    </div>

    <!-- Stats Section -->
    <div class="row mt-5">
        <div class="col-md-4 mb-4">
            <div class="stats-card text-center p-4 animate__animated animate__fadeInLeft" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border-radius: 15px; color: white;">
                <i class="fas fa-calendar-check fa-3x mb-3"></i>
                <h3>{{ events|length }}</h3>
                <p class="mb-0">Événements à venir</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="stats-card text-center p-4 animate__animated animate__fadeInUp" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 15px; color: #333;">
                <i class="fas fa-users fa-3x mb-3"></i>
                <h3>Clubs</h3>
                <p class="mb-0">Actifs</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="stats-card text-center p-4 animate__animated animate__fadeInRight" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); border-radius: 15px; color: #333;">
                <i class="fas fa-heart fa-3x mb-3"></i>
                <h3>Communauté</h3>
                <p class="mb-0">Engagée</p>
            </div>
        </div>
    </div>
</div>

<!-- Event Details Modal -->
<div class="modal fade" id="eventModal" tabindex="-1" role="dialog" aria-labelledby="eventModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content" style="border-radius: 20px; border: none; box-shadow: 0 20px 60px rgba(0,0,0,0.2);">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 20px 20px 0 0; border-bottom: none;">
                <h5 class="modal-title" id="eventModalLabel">
                    <i class="fas fa-calendar-day mr-2"></i>Détails de l'événement
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close" onclick="$('#eventModal').modal('hide');">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body p-4">
                <div class="row">
                    <div class="col-md-8">
                        <h3 id="modalEventTitle" class="text-primary mb-3"></h3>
                        <div class="mb-3">
                            <i class="fas fa-clock text-muted mr-2"></i>
                            <strong>Date:</strong> <span id="modalEventDate"></span>
                        </div>
                        <div class="mb-3">
                            <i class="fas fa-map-marker-alt text-muted mr-2"></i>
                            <strong>Lieu:</strong> <span id="modalEventLocation"></span>
                        </div>
                        <div class="mb-3">
                            <i class="fas fa-info-circle text-muted mr-2"></i>
                            <strong>Statut:</strong> <span id="modalEventStatus" class="badge"></span>
                        </div>
                        <div class="mb-3">
                            <i class="fas fa-align-left text-muted mr-2"></i>
                            <strong>Description:</strong>
                            <p id="modalEventDescription" class="mt-2"></p>
                        </div>
                    </div>
                    <div class="col-md-4 text-center">
                        <div class="event-icon mb-4">
                            <i class="fas fa-calendar-star fa-5x text-primary animate__animated animate__pulse animate__infinite"></i>
                        </div>
                        <button class="btn btn-primary btn-lg btn-block animate__animated animate__bounceIn">
                            <i class="fas fa-external-link-alt mr-2"></i>Voir plus de détails
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="border-top: none; border-radius: 0 0 20px 20px;">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="$('#eventModal').modal('hide');">
                    <i class="fas fa-times mr-2"></i>Fermer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Custom CSS -->
<style>
.hero-calendar {
    position: relative;
    overflow: hidden;
}

.hero-calendar::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
    animation: float 20s infinite linear;
}

@keyframes float {
    0% { transform: translateX(-50%) translateY(-50%) rotate(0deg); }
    100% { transform: translateX(-50%) translateY(-50%) rotate(360deg); }
}

.calendar-wrapper {
    position: relative;
    overflow: hidden;
}

.calendar-wrapper::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.05) 50%, transparent 70%);
    animation: shimmer 3s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.stats-card {
    transition: all 0.3s ease;
    cursor: pointer;
}

.stats-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
}

.fc-daygrid-event {
    border-radius: 8px !important;
    border: none !important;
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
}

.fc-daygrid-event:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.fc-button {
    border-radius: 8px !important;
    border: none !important;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    transition: all 0.3s ease !important;
}

.fc-button:hover {
    background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%) !important;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.fc-header-toolbar {
    margin-bottom: 2rem !important;
}

.animate__delay-1s {
    animation-delay: 1s;
}

.animate__delay-2s {
    animation-delay: 2s;
}
</style>

<!-- Scripts -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'fr',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: {{ events|safe }},
        eventClick: function(info) {
            // Populate modal with event details
            document.getElementById('modalEventTitle').textContent = info.event.title;
            document.getElementById('modalEventDate').textContent = info.event.start.toLocaleDateString('fr-FR', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('modalEventLocation').textContent = info.event.extendedProps.location || 'Non spécifié';
            document.getElementById('modalEventStatus').textContent = info.event.extendedProps.status || 'Non spécifié';
            document.getElementById('modalEventDescription').textContent = info.event.extendedProps.description || 'Aucune description disponible.';

            // Set status badge color
            var statusBadge = document.getElementById('modalEventStatus');
            var status = info.event.extendedProps.status;
            statusBadge.className = 'badge';
            if (status === 'planifie') {
                statusBadge.classList.add('badge-primary');
            } else if (status === 'en_cours') {
                statusBadge.classList.add('badge-success');
            } else if (status === 'termine') {
                statusBadge.classList.add('badge-secondary');
            } else {
                statusBadge.classList.add('badge-danger');
            }

            $('#eventModal').modal('show');
        },
        eventMouseEnter: function(info) {
            info.el.style.transform = 'scale(1.05)';
            info.el.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
        },
        eventMouseLeave: function(info) {
            info.el.style.transform = 'scale(1)';
            info.el.style.boxShadow = 'none';
        },
        dayMaxEvents: 3,
        moreLinkClick: 'popover',
        eventDisplay: 'block',
        eventTimeFormat: {
            hour: '2-digit',
            minute: '2-digit',
            meridiem: false
        }
    });

    calendar.render();

    // Add some entrance animations
    setTimeout(function() {
        document.querySelectorAll('.fc-daygrid-event').forEach(function(eventEl, index) {
            eventEl.style.animation = 'fadeInUp 0.6s ease-out ' + (index * 0.1) + 's both';
        });
    }, 1000);
});

// Add custom animations
var style = document.createElement('style');
style.textContent = `
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
`;
document.head.appendChild(style);
</script>

{% endblock %}
